<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GARAK ELAKARIA Real Estate Form</title>
<style>
body { font-family: Arial, sans-serif; direction: rtl; margin: 20px; }
h1 { text-align: center; }
form { max-width: 600px; margin: auto; }
label { display: block; margin-top: 15px; font-weight: bold; }
input, select { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
button { margin-top: 20px; padding: 10px 20px; font-size: 16px; cursor: pointer; }
.hidden { display: none; }
.success-message { text-align:center; color: green; font-weight:bold; margin-top:20px; }
</style>
</head>
<body>

<h1>GARAK ELAKARIA Real Estate Form</h1>

<form id="realEstateForm" novalidate>

<label>ูู ุชุฑูุฏ ุดุฑุงุก ุดูุฉ ุฃู ุจูุน ุดูุฉุ</label>
<select id="transactionType">
  <option value="">ุงุฎุชุฑ</option>
  <option value="buy">ุงุดุชุฑู ุดูุฉ</option>
  <option value="sell">ุจูุน ุดูุฉ</option>
</select>

<div id="buySection" class="hidden">
  <label>ุงูุงุณู</label>
  <input type="text" id="buyName">

  <label>ุงูุฏููุฉ</label>
  <select id="buyCountry">
    <option value="">ุงุฎุชุฑ ุงูุฏููุฉ</option>
    <option value="EG">๐ช๐ฌ ูุตุฑ (+20)</option>
    <option value="SA">๐ธ๐ฆ ุงูุณุนูุฏูุฉ (+966)</option>
    <option value="AE">๐ฆ๐ช ุงูุฅูุงุฑุงุช (+971)</option>
    <option value="QA">๐ถ๐ฆ ูุทุฑ (+974)</option>
    <option value="KW">๐ฐ๐ผ ุงููููุช (+965)</option>
    <option value="YE">๐พ๐ช ุงูููู (+967)</option>
    <option value="IQ">๐ฎ๐ถ ุงูุนุฑุงู (+964)</option>
  </select>

  <label>ุฑูู ุงูููุจุงูู</label>
  <input type="text" id="buyPhone" placeholder="ุงูุชุจ ุงูุฑูู ูุงููุงู">

  <label>ูู ุฃู ููุทูุฉ ูู ุทูุทุงุ</label>
  <select id="buyArea">
    <option value="">ุงุฎุชุฑ ุงูููุทูุฉ</option>
    <option>ุงูุงุณุชุงุฏ</option>
    <option>ุดูุจุฑ</option>
    <option>ุดุงุฑุน ุงูุจุญุฑ</option>
    <option>ุดุงุฑุน ุงููุญุงุณ</option>
    <option>ุดุงุฑุน ุงูุญูู</option>
    <option>ุดุงุฑุน ุณุนูุฏ</option>
    <option>ุดุงุฑุน ูุญุจ</option>
    <option>ุดุงุฑุน ุงูุงุดุฑู</option>
    <option>ุดุงุฑุน ุญุณุงู</option>
    <option>ุงูุฌูุงุก</option>
    <option>ุญู ุงูู</option>
    <option>ุญู ุซุงู</option>
    <option>ุชุฑุนู ุงูุดูุชู</option>
    <option>ุงูุนุฌูุฒู</option>
    <option>ุณูุฌุฑ</option>
    <option>ุงูุญููู</option>
    <option>ููุทูู ุณุจุฑุจุงู</option>
    <option>ููุทูู ุงููุญุทู</option>
  </select>

  <label>ุณุนุฑ ุงููุงุด ุงููุชุงุญ ูุนู</label>
  <select id="buyCash">
    <option value="">ุงุฎุชุฑ</option>
    <option>ูู ููููู ู ููููู ููุต</option>
    <option>ูู ููููู ููุตู ู 2 ููููู</option>
    <option>ูู 2 ููููู ู 2ููุตู ููููู</option>
    <option>ูู 2ููุตู ููููู ู 3 ููููู</option>
    <option>ูู 3 ููููู ู 3 ููุตู ููููู</option>
    <option>ูู 3 ููุตู ููููู ู 4 ููููู</option>
    <option>ูู 4 ููููู ู 5 ููููู</option>
    <option>ูู 5 ููููู ู 6 ููููู</option>
    <option>ุงูุชุฑ ูู 7 ููููู</option>
  </select>

  <label>ุงูุดูุฉ ูู ุญุฏูุฏ ุงูุณุนุฑ ูุงู ูุชุฑุ</label>
  <select id="buyAreaSize">
    <option value="">ุงุฎุชุฑ</option>
    <option>ูู 80 ูุชุฑ ู 110 ูุชุฑ</option>
    <option>ูู 110 ูุชุฑ ู 130 ูุชุฑ</option>
    <option>ูู 130 ู 150 ูุชุฑ</option>
    <option>ูู 150 ู 190 ูุชุฑ</option>
    <option>ูู 190 ู 230 ูุชุฑ</option>
    <option>ูู 230 ู 270 ูุชุฑ</option>
  </select>

  <label>ูู ุงูุดูุฉ ูุชุดุทุจุฉุ</label>
  <select id="buyFinishing">
    <option value="">ุงุฎุชุฑ</option>
    <option>ุนุงูุฒูุง ูุชุดุทุจู</option>
    <option>ุนุงูุฒูุง ูุต ุชุดุทูุจ</option>
    <option>ุนุงูุฒูุง ุนูู ุงูุทูุจ</option>
    <option>ุนุงูุฒูุง ุนูู ุงูุทูุจ ุงู ูุต ุชุดุทูุจ ุนุงุฏู</option>
  </select>
</div>

<div id="sellSection" class="hidden">
  <label>ุงูุงุณู</label>
  <input type="text" id="sellName">

  <label>ุงูุฏููุฉ</label>
  <select id="sellCountry">
    <option value="">ุงุฎุชุฑ ุงูุฏููุฉ</option>
    <option value="EG">๐ช๐ฌ ูุตุฑ (+20)</option>
    <option value="SA">๐ธ๐ฆ ุงูุณุนูุฏูุฉ (+966)</option>
    <option value="AE">๐ฆ๐ช ุงูุฅูุงุฑุงุช (+971)</option>
    <option value="QA">๐ถ๐ฆ ูุทุฑ (+974)</option>
    <option value="KW">๐ฐ๐ผ ุงููููุช (+965)</option>
    <option value="YE">๐พ๐ช ุงูููู (+967)</option>
    <option value="IQ">๐ฎ๐ถ ุงูุนุฑุงู (+964)</option>
  </select>

  <label>ุฑูู ุงูููุจุงูู</label>
  <input type="text" id="sellPhone">

  <label>ููุงู ุงูุดูุฉ</label>
  <input type="text" id="sellLocation">

  <label>ูุณุงุญุฉ ุงูุดูุฉ ุจุงููุชุฑ</label>
  <input type="number" id="sellSize" min="1">

  <label>ูู ุงูุดูุฉ ูุชุดุทุจุฉุ</label>
  <select id="sellFinishing">
    <option value="">ุงุฎุชุฑ</option>
    <option>ุนูู ุงูุทูุจ</option>
    <option>ูุต ุชุดุทูุจ</option>
    <option>ูุชุดุทุจู</option>
  </select>

  <label>ูู ูู ุงููุฑู ุฌุงูุฒุ</label>
  <select id="sellPaperwork">
    <option value="">ุงุฎุชุฑ</option>
    <option>ุงููุฑู ุณููู ูุฌุงูุฒู ุนูู ุงูุจูุน</option>
    <option>ููู ูุดููุฉ ุตุบูุฑู ุจุณ</option>
  </select>

  <label>ุณุนุฑ ุงูุจูุน</label>
  <select id="sellPrice">
    <option value="">ุงุฎุชุฑ</option>
    <option>ูู 500 ุงูู ู ููููู</option>
    <option>ูู ููููู ู ููููู ููุตู</option>
    <option>ูู ููููู ููุตู ู 2 ููููู</option>
    <option>ูู 2 ููููู ู 2ููุตู ููููู</option>
    <option>ูู 2ููุตู ููููู ู 3 ููููู</option>
    <option>ูู 3 ููููู ู 3 ููุตู ููููู</option>
    <option>ูู 3 ููุตู ููููู ู 4 ููููู</option>
    <option>ูู 4 ููููู ู 5 ููููู</option>
    <option>ูู 5 ููููู ู 6 ููููู</option>
    <option>ุงูุชุฑ ูู 7 ููููู</option>
  </select>
</div>

<button type="submit" id="submitBtn">ุฅุฑุณุงู</button>
<div class="success-message hidden" id="successMessage">
ุดูุฑุง ุนูู ุชุนุงููู ูุน ุฌุงุฑู ุงูุนูุงุฑูุฉ. ุณูุชู ุงูุชูุงุตู ูุนู ูุฑูุจุงู.
</div>

<script>
const transactionType = document.getElementById('transactionType');
const buySection = document.getElementById('buySection');
const sellSection = document.getElementById('sellSection');
const form = document.getElementById('realEstateForm');
const submitBtn = document.getElementById('submitBtn');

transactionType.addEventListener('change', () => {
  buySection.classList.toggle('hidden', transactionType.value !== 'buy');
  sellSection.classList.toggle('hidden', transactionType.value !== 'sell');
});

function validatePhone(country, phone){
  phone = phone.replace(/\D/g,'');
  const rules = {
    EG: [/^01\d{9}$/, '+20', 1],
    SA: [/^05\d{8}$/, '+966', 1],
    AE: [/^05\d{8}$/, '+971', 1],
    QA: [/^[3567]\d{7}$/, '+974', 0],
    KW: [/^[569]\d{7}$/, '+965', 0],
    YE: [/^\d{9}$/, '+967', 0],
    IQ: [/^\d{10}$/, '+964', 0]
  };
  if(!rules[country]) return null;
  const [regex, code, slice] = rules[country];
  if(!regex.test(phone)) return null;
  return code + (slice ? phone.slice(slice) : phone);
}

form.addEventListener('submit', async (e)=>{
  e.preventDefault();
  document.getElementById('successMessage').classList.add('hidden');

  if(!transactionType.value){
    alert('ุงุฎุชุฑ ููุน ุงููุนุงููุฉ');
    return;
  }

  let data = {};
  let webhookURL = '';

  if(transactionType.value === 'buy'){
    const name = buyName.value.trim();
    const country = buyCountry.value;
    const phone = validatePhone(country, buyPhone.value);
    if(!name || !country || !phone || !buyArea.value || !buyCash.value || !buyAreaSize.value || !buyFinishing.value){
      alert('ุฑุฌุงุกู ุฃููู ุงูุจูุงูุงุช ุจุดูู ุตุญูุญ');
      return;
    }
    webhookURL = 'https://osha1254.app.n8n.cloud/webhook/BUY';
    data = {type:'buy', name, country, phone, area:buyArea.value, cash:buyCash.value, size:buyAreaSize.value, finishing:buyFinishing.value};
  }

  if(transactionType.value === 'sell'){
    const name = sellName.value.trim();
    const country = sellCountry.value;
    const phone = validatePhone(country, sellPhone.value);
    if(!name || !country || !phone || !sellLocation.value.trim() || !sellSize.value || !sellFinishing.value || !sellPaperwork.value || !sellPrice.value){
      alert('ุฑุฌุงุกู ุฃููู ุงูุจูุงูุงุช ุจุดูู ุตุญูุญ');
      return;
    }
    webhookURL = 'https://osha1254.app.n8n.cloud/webhook/SALE';
    data = {type:'sell', name, country, phone, location:sellLocation.value, size:sellSize.value, finishing:sellFinishing.value, paperwork:sellPaperwork.value, price:sellPrice.value};
  }

  try{
    submitBtn.disabled = true;
    submitBtn.textContent = 'ุฌุงุฑู ุงูุฅุฑุณุงู...';

    const res = await fetch(webhookURL,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify(data)
    });

    if(!res.ok) throw new Error();

    form.reset();
    buySection.classList.add('hidden');
    sellSection.classList.add('hidden');
    document.getElementById('successMessage').classList.remove('hidden');
  }catch(err){
    alert('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุฅุฑุณุงู');
  }finally{
    submitBtn.disabled = false;
    submitBtn.textContent = 'ุฅุฑุณุงู';
  }
});
</script>

</body>
</html>
