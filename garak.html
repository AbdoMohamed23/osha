<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GARAK ELAKARIA Real Estate Form</title>
<style>
body { font-family: Arial, sans-serif; direction: rtl; margin: 20px; }
h1 { text-align: center; }
form { max-width: 600px; margin: auto; }
label { display: block; margin-top: 15px; font-weight: bold; }
input, select { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
button { margin-top: 20px; padding: 10px 20px; font-size: 16px; }
.hidden { display: none; }
.success-message { text-align:center; color: green; font-weight:bold; margin-top:20px; }
</style>
</head>
<body>

<h1>GARAK ELAKARIA Real Estate Form</h1>

<form id="realEstateForm">

<label>ูู ุชุฑูุฏ ุดุฑุงุก ุดูุฉ ุฃู ุจูุน ุดูุฉุ</label>
<select id="transactionType" required>
  <option value="">ุงุฎุชุฑ</option>
  <option value="buy">ุงุดุชุฑู ุดูุฉ</option>
  <option value="sell">ุจูุน ุดูุฉ</option>
</select>

<!-- ุดุฑุงุก ุงูุดูุฉ -->
<div id="buySection" class="hidden">
  <label>ุงูุงุณู</label>
  <input type="text" id="buyName" required>

  <label>ุงูุฏููุฉ</label>
  <select id="buyCountry" required>
    <option value="">ุงุฎุชุฑ ุงูุฏููุฉ</option>
    <option value="EG">๐ช๐ฌ ูุตุฑ (+20)</option>
    <option value="SA">๐ธ๐ฆ ุงูุณุนูุฏูุฉ (+966)</option>
    <option value="AE">๐ฆ๐ช ุงูุฅูุงุฑุงุช (+971)</option>
    <option value="QA">๐ถ๐ฆ ูุทุฑ (+974)</option>
    <option value="KW">๐ฐ๐ผ ุงููููุช (+965)</option>
    <option value="YE">๐พ๐ช ุงูููู (+967)</option>
    <option value="IQ">๐ฎ๐ถ ุงูุนุฑุงู (+964)</option>
  </select>

  <label>ุฑูู ุงูููุจุงูู</label>
  <input type="text" id="buyPhone" placeholder="ุงูุชุจ ุงูุฑูู ูุงููุงู" required>

  <label>ูู ุฃู ููุทูุฉ ูู ุทูุทุงุ</label>
  <select id="buyArea" required>
    <option value="">ุงุฎุชุฑ ุงูููุทูุฉ</option>
    <option>ุงูุงุณุชุงุฏ</option>
    <option>ุดูุจุฑ</option>
    <option>ุดุงุฑุน ุงูุจุญุฑ</option>
    <option>ุดุงุฑุน ุงููุญุงุณ</option>
    <option>ุดุงุฑุน ุงูุญูู</option>
    <option>ุดุงุฑุน ุณุนูุฏ</option>
    <option>ุดุงุฑุน ูุญุจ</option>
    <option>ุดุงุฑุน ุงูุงุดุฑู</option>
    <option>ุดุงุฑุน ุญุณุงู</option>
    <option>ุงูุฌูุงุก</option>
    <option>ุญู ุงูู</option>
    <option>ุญู ุซุงู</option>
    <option>ุชุฑุนู ุงูุดูุชู</option>
    <option>ุงูุนุฌูุฒู</option>
    <option>ุณูุฌุฑ</option>
    <option>ุงูุญููู</option>
    <option>ููุทูู ุณุจุฑุจุงู</option>
    <option>ููุทูู ุงููุญุทู</option>
  </select>

  <label>ุณุนุฑ ุงููุงุด ุงููุชุงุญ ูุนู</label>
  <select id="buyCash" required>
    <option value="">ุงุฎุชุฑ</option>
    <option>ูู ููููู ู ููููู ููุต</option>
    <option>ูู ููููู ููุตู ู 2 ููููู</option>
    <option>ูู 2 ููููู ู 2ููุตู ููููู</option>
    <option>ูู 2ููุตู ููููู ู 3 ููููู</option>
    <option>ูู 3 ููููู ู 3 ููุตู ููููู</option>
    <option>ูู 3 ููุตู ููููู ู 4 ููููู</option>
    <option>ูู 4 ููููู ู 5 ููููู</option>
    <option>ูู 5 ููููู ู 6 ููููู</option>
    <option>ุงูุชุฑ ูู 7 ููููู</option>
  </select>

  <label>ุงูุดูุฉ ูู ุญุฏูุฏ ุงูุณุนุฑ ูุงู ูุชุฑุ</label>
  <select id="buyAreaSize" required>
    <option value="">ุงุฎุชุฑ</option>
    <option>ูู 80 ูุชุฑ ู 110 ูุชุฑ</option>
    <option>ูู 110 ูุชุฑ ู 130 ูุชุฑ</option>
    <option>ูู 130 ู 150 ูุชุฑ</option>
    <option>ูู 150 ู 190 ูุชุฑ</option>
    <option>ูู 190 ู 230 ูุชุฑ</option>
    <option>ูู 230 ู 270 ูุชุฑ</option>
  </select>

  <label>ูู ุงูุดูุฉ ูุชุดุทุจุฉุ</label>
  <select id="buyFinishing" required>
    <option value="">ุงุฎุชุฑ</option>
    <option>ุนุงูุฒูุง ูุชุดุทุจู</option>
    <option>ุนุงูุฒูุง ูุต ุชุดุทูุจ</option>
    <option>ุนุงูุฒูุง ุนูู ุงูุทูุจ</option>
    <option>ุนุงูุฒูุง ุนูู ุงูุทูุจ ุงู ูุต ุชุดุทูุจ ุนุงุฏู</option>
  </select>

</div>

<!-- ุจูุน ุงูุดูุฉ -->
<div id="sellSection" class="hidden">
  <label>ุงูุงุณู</label>
  <input type="text" id="sellName" required>

  <label>ุงูุฏููุฉ</label>
  <select id="sellCountry" required>
    <option value="">ุงุฎุชุฑ ุงูุฏููุฉ</option>
    <option value="EG">๐ช๐ฌ ูุตุฑ (+20)</option>
    <option value="SA">๐ธ๐ฆ ุงูุณุนูุฏูุฉ (+966)</option>
    <option value="AE">๐ฆ๐ช ุงูุฅูุงุฑุงุช (+971)</option>
    <option value="QA">๐ถ๐ฆ ูุทุฑ (+974)</option>
    <option value="KW">๐ฐ๐ผ ุงููููุช (+965)</option>
    <option value="YE">๐พ๐ช ุงูููู (+967)</option>
    <option value="IQ">๐ฎ๐ถ ุงูุนุฑุงู (+964)</option>
  </select>

  <label>ุฑูู ุงูููุจุงูู</label>
  <input type="text" id="sellPhone" placeholder="ุงูุชุจ ุงูุฑูู ูุงููุงู" required>

  <label>ููุงู ุงูุดูุฉ</label>
  <input type="text" id="sellLocation" placeholder="ุงูุดุงุฑุน ุงูุฑุฆูุณู" required>

  <label>ูุณุงุญุฉ ุงูุดูุฉ ุจุงููุชุฑ</label>
  <input type="number" id="sellSize" min="1" required>

  <label>ูู ุงูุดูุฉ ูุชุดุทุจุฉุ</label>
  <select id="sellFinishing" required>
    <option value="">ุงุฎุชุฑ</option>
    <option>ุนูู ุงูุทูุจ</option>
    <option>ูุต ุชุดุทูุจ</option>
    <option>ูุชุดุทุจู</option>
  </select>

  <label>ูู ูู ุงููุฑู ุฌุงูุฒุ</label>
  <select id="sellPaperwork" required>
    <option value="">ุงุฎุชุฑ</option>
    <option>ุงููุฑู ุณููู ูุฌุงูุฒู ุนูู ุงูุจูุน</option>
  </select>

  <label>ุณุนุฑ ุงูุจูุน</label>
  <select id="sellPrice" required>
    <option value="">ุงุฎุชุฑ</option>
    <option>ูู 500 ุงูู ู ููููู</option>
    <option>ูู ููููู ู ููููู ููุตู</option>
    <option>ูู ููููู ููุตู ู 2 ููููู</option>
    <option>ูู 2 ููููู ู 2ููุตู ููููู</option>
    <option>ูู 2ููุตู ููููู ู 3 ููููู</option>
    <option>ูู 3 ููููู ู 3 ููุตู ููููู</option>
    <option>ูู 3 ููุตู ููููู ู 4 ููููู</option>
    <option>ูู 4 ููููู ู 5 ููููู</option>
    <option>ูู 5 ููููู ู 6 ููููู</option>
    <option>ุงูุชุฑ ูู 7 ููููู</option>
  </select>

</div>

<button type="submit">ุฅุฑุณุงู</button>
<div class="success-message hidden" id="successMessage">
  ุดูุฑุง ุนูู ุชุนุงููู ูุน ุฌุงุฑู ุงูุนูุงุฑูุฉ. ุณูุชู ุงูุชูุงุตู ูุนู ุนูู ุงูุฑูู ุฅุฐุง ูุงู ุตุญูุญ.
</div>

<script>
const transactionType = document.getElementById('transactionType');
const buySection = document.getElementById('buySection');
const sellSection = document.getElementById('sellSection');

transactionType.addEventListener('change', () => {
  if(transactionType.value === 'buy') {
    buySection.classList.remove('hidden');
    sellSection.classList.add('hidden');
  } else if(transactionType.value === 'sell') {
    sellSection.classList.remove('hidden');
    buySection.classList.add('hidden');
  } else {
    buySection.classList.add('hidden');
    sellSection.classList.add('hidden');
  }
});

// ุฑูุงุจุท Webhook
const WEBHOOK_BUY = 'https://osha1254.app.n8n.cloud/webhook/BUY';
const WEBHOOK_SELL = 'https://osha1254.app.n8n.cloud/webhook/SALE';

const form = document.getElementById('realEstateForm');

form.addEventListener('submit', (e) => {
  e.preventDefault();

  let data = {};
  let phone = '';
  let country = '';

  if(transactionType.value === 'buy') {
    const name = document.getElementById('buyName').value.trim();
    country = document.getElementById('buyCountry').value;
    phone = document.getElementById('buyPhone').value.trim();
    const area = document.getElementById('buyArea').value;
    const cash = document.getElementById('buyCash').value;
    const size = document.getElementById('buyAreaSize').value;
    const finishing = document.getElementById('buyFinishing').value;

    if(!name || !country || !phone || !area || !cash || !size || !finishing){
      alert('ุฑุฌุงุกู ุฃููู ูู ุงูุญููู');
      return;
    }

    // Validation ู ุชุญููู ุฑูู ุงููุงุชู
    phone = phone.replace(/\D/g,'');
    if(country==='EG'){
      if(!/^01\d{9}$/.test(phone)){
        alert('ุฑูู ูุตุฑู ุบูุฑ ุตุญูุญ. ูุฌุจ ุฃู ูุจุฏุฃ ุจู 01 ููุชููู ูู 11 ุฑูู.');
        return;
      }
      phone = '+20' + phone.slice(1);
    } else if(country==='SA'){
      phone = '+966' + phone.slice(1);
    } else if(country==='AE'){
      phone = '+971' + phone.slice(1);
    } else if(country==='QA'){
      phone = '+974' + phone;
    } else if(country==='KW'){
      phone = '+965' + phone;
    } else if(country==='YE'){
      phone = '+967' + phone;
    } else if(country==='IQ'){
      phone = '+964' + phone;
    }

    data = {type:'buy', name, country, phone, area, cash, size, finishing};

  } else if(transactionType.value === 'sell') {
    const name = document.getElementById('sellName').value.trim();
    country = document.getElementById('sellCountry').value;
    phone = document.getElementById('sellPhone').value.trim();
    const location = document.getElementById('sellLocation').value.trim();
    const size = document.getElementById('sellSize').value.trim();
    const finishing = document.getElementById('sellFinishing').value;
    const paperwork = document.getElementById('sellPaperwork').value;
    const price = document.getElementById('sellPrice').value;

    if(!name || !country || !phone || !location || !size || !finishing || !paperwork || !price){
      alert('ุฑุฌุงุกู ุฃููู ูู ุงูุญููู');
      return;
    }

    phone = phone.replace(/\D/g,'');
    if(country==='EG'){
      if(!/^01\d{9}$/.test(phone)){
        alert('ุฑูู ูุตุฑู ุบูุฑ ุตุญูุญ. ูุฌุจ ุฃู ูุจุฏุฃ ุจู 01 ููุชููู ูู 11 ุฑูู.');
        return;
      }
      phone = '+20' + phone.slice(1);
    } else if(country==='SA'){
      phone = '+966' + phone.slice(1);
    } else if(country==='AE'){
      phone = '+971' + phone.slice(1);
    } else if(country==='QA'){
      phone = '+974' + phone;
    } else if(country==='KW'){
      phone = '+965' + phone;
    } else if(country==='YE'){
      phone = '+967' + phone;
    } else if(country==='IQ'){
      phone = '+964' + phone;
    }

    data = {type:'sell', name, country, phone, location, size, finishing, paperwork, price};
  } else {
    alert('ุงุฎุชุฑ ููุน ุงููุนุงููุฉ');
    return;
  }

  // ุชุญุฏูุฏ Webhook ุญุณุจ ุงูุงุฎุชูุงุฑ
  let webhookURL = (transactionType.value === 'buy') ? WEBHOOK_BUY : WEBHOOK_SELL;

  fetch(webhookURL, {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify(data)
  })
  .then(res=>{
    if(res.ok){
      form.reset();
      buySection.classList.add('hidden');
      sellSection.classList.add('hidden');
      document.getElementById('successMessage').classList.remove('hidden');
    } else {
      alert('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุฅุฑุณุงู.');
    }
  })
  .catch(err=>{
    alert('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุฅุฑุณุงู.');
    console.error(err);
  });

});
</script>

</body>
</html>
